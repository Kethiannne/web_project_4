(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t=function(){function t(e){var n=e.baseURL,r=e.headers;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._baseURL=n,this._headers=r}var n,r;return n=t,(r=[{key:"_successfulReturn",value:function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}},{key:"getInitialCards",value:function(){var e=this;return fetch(this._baseURL+"/cards",{headers:this._headers}).then((function(t){return e._successfulReturn(t)}))}},{key:"addCard",value:function(e){var t=this,n=e.link,r=e.name;return fetch(this._baseURL+"/cards",{headers:this._headers,method:"POST",body:JSON.stringify({link:n,name:r})}).then((function(e){return t._successfulReturn(e)}))}},{key:"deleteCard",value:function(e){var t=this;return fetch(this._baseURL+"/cards/"+e,{headers:this._headers,method:"DELETE"}).then((function(e){return t._successfulReturn(e)}))}},{key:"updateLikeTrue",value:function(e){var t=this;return fetch(this._baseURL+"/cards/likes/"+e,{headers:this._headers,method:"PUT"}).then((function(e){return t._successfulReturn(e)}))}},{key:"updateLikeFalse",value:function(e){var t=this;return fetch(this._baseURL+"/cards/likes/"+e,{headers:this._headers,method:"DELETE"}).then((function(e){return t._successfulReturn(e)}))}},{key:"getUserInfo",value:function(){var e=this;return fetch(this._baseURL+"/users/me",{headers:this._headers}).then((function(t){return e._successfulReturn(t)}))}},{key:"updateUserInfo",value:function(e){var t=this;return fetch(this._baseURL+"/users/me",{headers:this._headers,method:"PATCH",body:JSON.stringify(e)}).then((function(e){return t._successfulReturn(e)}))}},{key:"updateAvatar",value:function(e){var t=this;return fetch(this._baseURL+"/users/me/avatar",{headers:this._headers,method:"PATCH",body:JSON.stringify(e)}).then((function(e){return t._successfulReturn(e)}))}}])&&e(n.prototype,r),t}();function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popup=t,this._closeEscape=this._closeEscape.bind(this)}var t,r;return t=e,(r=[{key:"openPopup",value:function(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._closeEscape)}},{key:"closePopup",value:function(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._closeEscape)}},{key:"_closeEscape",value:function(e){"Escape"===e.key&&this.closePopup()}},{key:"setEventListeners",value:function(){var e=this;this._closeButton=this._popup.querySelector(".popup__close-button"),this._closeButton.addEventListener("click",(function(){e.closePopup()})),this._popup.addEventListener("click",(function(t){t.target===t.currentTarget&&e.closePopup()}))}}])&&n(t.prototype,r),e}();function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?c(e):t}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(p,e);var t,n,r,o,f=(r=p,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(o){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function p(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(n=f.call(this,e))._form=n._popup.querySelector(".form"),n._submit=t,n._closeEnter=n._closeEnter.bind(c(n)),n}return t=p,(n=[{key:"openPopup",value:function(e,t){u(l(p.prototype),"openPopup",this).call(this),this._id=e,this._card=t,document.addEventListener("keydown",this._closeEnter)}},{key:"closePopup",value:function(){document.removeEventListener("keydown",this._closeEnter),u(l(p.prototype),"closePopup",this).call(this)}},{key:"_handleSubmit",value:function(e){e.preventDefault(),this._submit(this._id,this._card),document.removeEventListener("keydown",this._closeEnter)}},{key:"_closeEnter",value:function(e){"Enter"===e.key&&this._handleSubmit(e)}},{key:"setEventListeners",value:function(){var e=this;u(l(p.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",(function(t){e._handleSubmit(t)}))}}])&&i(t.prototype,n),p}(r);function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var h=function(){function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items=r,this._renderer=o,this._container=n}var t,n;return t=e,(n=[{key:"renderElements",value:function(){var e=this;this._items.forEach((function(t){e._renderer(t)}))}},{key:"addItem",value:function(e){this._container.append(e)}},{key:"prepItem",value:function(e){this._container.prepend(e)}}])&&p(t.prototype,n),e}();function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(t,n,r,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._text=t.name,this._imageLink=t.link,this._template=n,this._id=t._id,this._owner=t.owner._id,this._likes=t.likes,this._handleCardClick=r,this._handleDeleteClick=o,this._handleLikeClick=i}var t,n;return t=e,(n=[{key:"_getTemplate",value:function(){return document.querySelector(this._template).content.querySelector(".elements__element").cloneNode(!0)}},{key:"_handleCardLike",value:function(e){this._isLiked=!this._isLiked,this._handleLikeClick(this._id,this._isLiked,this)}},{key:"_isAlreadyLiked",value:function(e){var t=this;this._likes.forEach((function(n){n._id===e&&(t._placeCard.querySelector(".elements__heart").classList.add("elements__heart_active"),t._isLiked=!t._isLiked)}))}},{key:"updateLikes",value:function(e){this._likesCount.textContent=e.likes.length,this._placeCard.querySelector(".elements__heart").classList.toggle("elements__heart_active")}},{key:"_setEventListeners",value:function(){var e=this;this._placeCard.querySelector(".elements__image").addEventListener("click",(function(t){t.target===t.currentTarget&&e._handleCardClick(e._text,e._imageLink)})),this._placeCard.querySelector(".elements__heart").addEventListener("click",(function(t){e._handleCardLike(t)}))}},{key:"_isOwner",value:function(e){var t=this;this._owner!==e?this._placeCard.querySelector(".elements__delete").remove():this._placeCard.querySelector(".elements__delete").addEventListener("click",(function(){t._handleDeleteClick(t._id,t._placeCard)}))}},{key:"makeCard",value:function(e){return this._placeCard=this._getTemplate(),this._likesCount=this._placeCard.querySelector(".elements__like-count"),this._placeCard.querySelector(".elements__title").textContent=this._text,this._placeCard.querySelector(".elements__image").style.backgroundImage="url(".concat(this._imageLink,")"),this._likesCount.textContent=this._likes.length,this._setEventListeners(),this._isOwner(e),this._isAlreadyLiked(e),this._placeCard}}])&&_(t.prototype,n),e}();function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t,n){return(m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k(e,t){return!t||"object"!==y(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=g(r);if(o){var n=g(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return k(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this,e))._popupImage=t._popup.querySelector(".image-popup"),t._popupCaption=t._popup.querySelector(".image-caption"),t}return t=u,(n=[{key:"openPopup",value:function(e,t){this._popupImage.src=t,this._popupImage.alt=e,this._popupCaption.textContent=e,m(g(u.prototype),"openPopup",this).call(this)}}])&&v(t.prototype,n),u}(r);function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C(e,t,n){return(C="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=P(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e,t){return!t||"object"!==S(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=P(r);if(o){var n=P(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return O(this,e)});function u(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(r=i.call(this,e))._form=r._popup.querySelector(".form"),r._formSubmit=t,r._formOpen=n,r}return t=u,(n=[{key:"renderLoading",value:function(e){this._saveButton=this._form.querySelector(".form__save-button"),this._saveButton.textContent,this._saveButton.textContent=e?this._saveButton.textContent.slice(0,-1)+"ing...":this._saveButton.textContent.slice(0,-6)+"e"}},{key:"_getInputValues",value:function(){var e={};return Array.from(this._form.querySelectorAll(".form__field")).forEach((function(t){e[t.name]=t.value})),e}},{key:"setEventListeners",value:function(){var e=this;C(P(u.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",(function(t){t.preventDefault(),e._formSubmit(e._getInputValues())}))}},{key:"closePopup",value:function(){C(P(u.prototype),"closePopup",this).call(this),this._form.reset()}},{key:"openPopup",value:function(){C(P(u.prototype),"openPopup",this).call(this),this._formOpen()}}])&&L(t.prototype,n),u}(r);function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var j=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._formElement=n,this._saveButton=this._formElement.querySelector(this._submitButtonSelector)}var t,n;return t=e,(n=[{key:"_showInputError",value:function(e,t){var n=this._formElement.querySelector(".".concat(e.name,"-error"));e.classList.add(this._inputErrorClass),n.textContent=t,n.classList.add(this._errorClass)}},{key:"_hideInputError",value:function(e){var t=this._formElement.querySelector(".".concat(e.name,"-error"));e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_hasInvalidInput",value:function(e){return e.some((function(e){return!e.validity.valid}))}},{key:"_toggleButtonState",value:function(e){this._hasInvalidInput(e)?this.disableButton():this.enableButton()}},{key:"disableButton",value:function(){this._saveButton.setAttribute("disabled",!0),this._saveButton.classList.add(this._inactiveButtonClass)}},{key:"enableButton",value:function(){this._saveButton.removeAttribute("disabled",!0),this._saveButton.classList.remove(this._inactiveButtonClass)}},{key:"_setEventListeners",value:function(){var e=this,t=Array.from(this._formElement.querySelectorAll(this._inputSelector));this._toggleButtonState(t),t.forEach((function(n){n.addEventListener("input",(function(){e._checkInputValidity(n),e._toggleButtonState(t)}))})),this._formElement.addEventListener("submit",(function(e){e.preventDefault()}))}},{key:"enableValidation",value:function(){this._setEventListeners(this._formElement)}}])&&I(t.prototype,n),e}(),q={inputSelector:".form__field",submitButtonSelector:".form__save-button",inactiveButtonClass:"form__save-button_disabled",inputErrorClass:"form__field_error",errorClass:"form__field-error_active"},B=document.querySelector(".page"),T=B.querySelector(".profile"),x=B.querySelector(".popup_edit-form"),A=B.querySelector(".popup_add-form"),U=B.querySelector(".popup_avatar-form"),D=B.querySelector(".popup_delete"),N=T.querySelector(".profile__edit-button"),V=T.querySelector(".profile__name"),H=T.querySelector(".profile__occupation"),J=document.forms.edit,F=J.elements.name,M=J.elements.about,z=x.querySelector(".form__save-button"),Y=T.querySelector(".profile__add-button"),$=(A.querySelector(".form__save-button"),document.forms.add),G=T.querySelector(".profile__image-edit"),K=T.querySelector(".profile__avatar"),Q=document.forms.avatar,W=U.querySelector(".form__save-button"),X=document.querySelector(".card-container"),Z=document.querySelector(".popup_image");function ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}document.forms.delete,D.querySelector(".form__save-button");var te=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._profileImage=r,this._myName=t,this._myOccupation=n}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{name:this._myName.textContent,about:this._myOccupation.textContent}}},{key:"setUserInfo",value:function(e){this._myName.textContent=e.name,this._myOccupation.textContent=e.about,this._id=e._id,this.setAvatar(e)}},{key:"setAvatar",value:function(e){this._profileImage.setAttribute("src",e.avatar)}},{key:"getID",value:function(){return this._id}}])&&ee(t.prototype,n),e}();function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var re=new t({baseURL:"https://around.nomoreparties.co/v1/group-7",headers:{authorization:"a5454f22-eab5-4384-8e26-57b127f56551","Content-Type":"application/json"}});Promise.all([re.getUserInfo(),re.getInitialCards()]).then((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}}(t,n)||function(e,t){if(e){if("string"==typeof e)return ne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ne(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];oe.setUserInfo(o);var u=new R(x,(function(e){u.renderLoading(!0),re.updateUserInfo(e).then((function(e){oe.setUserInfo(e),u.closePopup(),u.renderLoading(!1)})).catch((function(e){console.log("Your profile is out of wack: ".concat(e))}))}),(function(){var e=oe.getUserInfo(),t=e.name,n=e.about;F.value=t,M.value=n,se.disableButton(z)}));u.setEventListeners(),N.addEventListener("click",(function(){u.openPopup()}));var a=new h({items:i,renderer:function(e){a.addItem(l(e))}},X);a.renderElements();var s=new R(A,(function(e){s.renderLoading(!0),re.addCard(e).then((function(e){a.prepItem(l(e)),s.closePopup(),s.renderLoading(!1)})).catch((function(e){console.log("Card could not be delivered as dialed: ".concat(e))}))}),(function(){ae.disableButton()}));function c(e,t){ie.openPopup(e,t)}function l(e){return new d(e,".owner-template",c,le,f).makeCard(oe.getID())}function f(e,t,n){t?re.updateLikeTrue(e).then((function(e){n.updateLikes(e)})).catch((function(e){console.log("Err, you sure you like that?: ".concat(e))})):re.updateLikeFalse(e).then((function(e){n.updateLikes(e)})).catch((function(e){console.log("C'mon, everyone loves that!: ".concat(e))}))}s.setEventListeners(),Y.addEventListener("click",(function(){s.openPopup()}));var p=new R(U,(function(e){p.renderLoading(!0),re.updateAvatar(e).then((function(e){oe.setAvatar({avatar:e.avatar}),p.closePopup(),p.renderLoading(!1)})).catch((function(e){console.log("Aang, your chi is out of focus: ".concat(e))}))}),(function(){ce.disableButton(W)}));p.setEventListeners(),G.addEventListener("click",(function(){p.openPopup()}))})).catch((function(e){console.log("Houston, we have a problem... this one in fact: ".concat(e))}));var oe=new te(V,H,K),ie=new E(Z);function ue(e){var t=new j(q,e);return t.enableValidation(),t}ie.setEventListeners();var ae=ue($),se=ue(J),ce=ue(Q);function le(e,t){fe.openPopup(e,t)}var fe=new f(D,(function(e,t){re.deleteCard(e).then(t.remove(),fe.closePopup()).catch((function(e){console.log("I'm sorry Dave, I'm afraid I can't do that: ".concat(e))}))}));fe.setEventListeners()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBEZWxldGUuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIl0sIm5hbWVzIjpbIkFwaSIsImJhc2VVUkwiLCJoZWFkZXJzIiwidGhpcyIsIl9iYXNlVVJMIiwiX2hlYWRlcnMiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZmV0Y2giLCJ0aGVuIiwiX3N1Y2Nlc3NmdWxSZXR1cm4iLCJsaW5rIiwibmFtZSIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiaWQiLCJjYXJkSUQiLCJ2YWx1ZXMiLCJQb3B1cCIsInBvcHVwIiwiX3BvcHVwIiwiX2Nsb3NlRXNjYXBlIiwiYmluZCIsImNsYXNzTGlzdCIsImFkZCIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJjbG9zZVBvcHVwIiwiX2Nsb3NlQnV0dG9uIiwicXVlcnlTZWxlY3RvciIsInRhcmdldCIsImN1cnJlbnRUYXJnZXQiLCJQb3B1cERlbGV0ZSIsInBvcHVwU2VsZWN0b3IiLCJwb3B1cFN1Ym1pdCIsIl9mb3JtIiwiX3N1Ym1pdCIsIl9jbG9zZUVudGVyIiwiY2FyZCIsIl9pZCIsIl9jYXJkIiwicHJldmVudERlZmF1bHQiLCJfaGFuZGxlU3VibWl0IiwiU2VjdGlvbiIsImNvbnRhaW5lciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiZm9yRWFjaCIsIml0ZW0iLCJlbGVtZW50IiwiYXBwZW5kIiwicHJlcGVuZCIsIkNhcmQiLCJkYXRhIiwidGVtcGxhdGUiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVEZWxldGVDbGljayIsImhhbmRsZUxpa2VDbGljayIsIl90ZXh0IiwiX2ltYWdlTGluayIsIl90ZW1wbGF0ZSIsIl9vd25lciIsIm93bmVyIiwiX2xpa2VzIiwibGlrZXMiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZUxpa2VDbGljayIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfaXNMaWtlZCIsInVzZXJJRCIsImxpa2UiLCJfcGxhY2VDYXJkIiwib2JqIiwiX2xpa2VzQ291bnQiLCJ0ZXh0Q29udGVudCIsImxlbmd0aCIsInRvZ2dsZSIsIl9oYW5kbGVDYXJkTGlrZSIsIl9nZXRUZW1wbGF0ZSIsInN0eWxlIiwiYmFja2dyb3VuZEltYWdlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2lzT3duZXIiLCJfaXNBbHJlYWR5TGlrZWQiLCJQb3B1cFdpdGhJbWFnZSIsIl9wb3B1cEltYWdlIiwiX3BvcHVwQ2FwdGlvbiIsInRleHQiLCJzcmMiLCJhbHQiLCJQb3B1cFdpdGhGb3JtIiwiZm9ybVN1Ym1pdCIsImZvcm1PcGVuIiwiX2Zvcm1TdWJtaXQiLCJfZm9ybU9wZW4iLCJpc0xvYWRpbmciLCJfc2F2ZUJ1dHRvbiIsInNsaWNlIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0IiwidmFsdWUiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJyZXNldCIsIkZvcm1WYWxpZGF0b3IiLCJjb25maWciLCJmb3JtIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiaW5wdXRMaXN0Iiwic29tZSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlQnV0dG9uIiwiZW5hYmxlQnV0dG9uIiwic2V0QXR0cmlidXRlIiwicmVtb3ZlQXR0cmlidXRlIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInNldHRpbmdzIiwicGFnZSIsInByb2ZpbGUiLCJwb3B1cEVkaXQiLCJwb3B1cEFkZCIsInBvcHVwQXZhdGFyIiwicG9wdXBEZWxldGUiLCJlZGl0IiwibXlOYW1lIiwibXlPY2N1cGF0aW9uIiwiZWRpdEZvcm0iLCJmb3JtcyIsIm5hbWVGb3JtIiwiZWxlbWVudHMiLCJvY2N1cGF0aW9uRm9ybSIsImFib3V0Iiwic2F2ZSIsImFkZEZvcm0iLCJhdmF0YXIiLCJhdmF0YXJJbWFnZSIsImF2YXRhckZvcm0iLCJhdmF0YXJTYXZlIiwiY2FyZENvbnRhaW5lciIsInBvcHVwSW1hZ2VzIiwiZGVsZXRlIiwiVXNlckluZm8iLCJwcm9maWxlSW1hZ2UiLCJfcHJvZmlsZUltYWdlIiwiX215TmFtZSIsIl9teU9jY3VwYXRpb24iLCJzZXRBdmF0YXIiLCJhcGkiLCJhdXRob3JpemF0aW9uIiwiYWxsIiwiZ2V0VXNlckluZm8iLCJnZXRJbml0aWFsQ2FyZHMiLCJyZXNVc2VySW5mbyIsInJlc0luaXRDYXJkcyIsInVzZXJJbmZvcm1hdGlvbiIsInNldFVzZXJJbmZvIiwiZWRpdFBvcHVwIiwiY29uc3RhbnRzIiwicmVuZGVyTG9hZGluZyIsInVwZGF0ZVVzZXJJbmZvIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiZWRpdFZhbGlkYXRvciIsInNldEV2ZW50TGlzdGVuZXJzIiwib3BlblBvcHVwIiwiY2FyZHMiLCJhZGRJdGVtIiwibWFrZUFOZXdDYXJkIiwicmVuZGVyRWxlbWVudHMiLCJhZGRQb3B1cCIsImFkZENhcmQiLCJwcmVwSXRlbSIsImFkZFZhbGlkYXRvciIsImltYWdlUG9wIiwibWFrZUNhcmQiLCJnZXRJRCIsImNhcmRJZCIsImlzTGlrZWQiLCJ1cGRhdGVMaWtlVHJ1ZSIsInVwZGF0ZUxpa2VzIiwidXBkYXRlTGlrZUZhbHNlIiwiYXZhdGFyUG9wdXAiLCJ1cGRhdGVBdmF0YXIiLCJhdmF0YXJWYWxpZGF0b3IiLCJuZXdWYWxpZGF0b3IiLCJmb3JtRWxlbWVudCIsIm5ld0Zvcm0iLCJlbmFibGVWYWxpZGF0aW9uIiwiZGVsZXRlUG9wdXAiLCJkZWxldGVDYXJkIl0sIm1hcHBpbmdzIjoiNkxBQXFCQSxFLFdBQ25CLGNBQWdDLElBQW5CQyxFQUFtQixFQUFuQkEsUUFBU0MsRUFBVSxFQUFWQSxTLDRGQUFVLFNBQzlCQyxLQUFLQyxTQUFXSCxFQUNoQkUsS0FBS0UsU0FBV0gsRSxzREFHbEIsU0FBa0JJLEdBQ2hCLE9BQUlBLEVBQUlDLEdBQ0NELEVBQUlFLE9BRUpDLFFBQVFDLE9BQVIsaUJB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QWE3QixHQUM1Qk8sR0FBZ0JzQixHQUFhN0IsR0FDN0I0QixHQUFrQkMsR0FBYTdCLEdBS3JDLFNBQVMzSCxHQUFrQmhELEVBQUkyQixHQUM3QmlMLEdBQVl4QixVQUFVcEwsRUFBSTJCLEdBRTVCLElBQU1pTCxHQUFjLElBQUl2TCxFQUN0QnNKLEdBQ0EsU0FBQzNLLEVBQUkyQixHQUNIc0ksR0FBSTRDLFdBQVc3TSxHQUNkUixLQUNDbUMsRUFBS2YsU0FDTGdNLEdBQVk1TCxjQUViOEosT0FBTSxTQUFBQyxHQUNMQyxRQUFRQyxJQUFSLHNEQUE0REYsVUFLbEU2QixHQUFZekIscUIiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHtiYXNlVVJMLCBoZWFkZXJzfSkge1xuICAgIHRoaXMuX2Jhc2VVUkwgPSBiYXNlVVJMO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xuICB9XG5cbiAgX3N1Y2Nlc3NmdWxSZXR1cm4ocmVzKXtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH1cbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVSTCArIGAvY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgfSlcbiAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zdWNjZXNzZnVsUmV0dXJuKHJlcyk7XG4gICAgICB9KVxuICB9XG5cbiAgYWRkQ2FyZCh7bGluaywgbmFtZX0pe1xuICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVVJMICsgYC9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe2xpbmssIG5hbWV9KVxuICAgIH0pXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3VjY2Vzc2Z1bFJldHVybihyZXMpO1xuICAgICAgfSlcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoaWQpe1xuICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVVJMICsgYC9jYXJkcy9gICsgaWQsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgfSlcbiAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zdWNjZXNzZnVsUmV0dXJuKHJlcyk7XG4gICAgICB9KVxuICB9XG5cbiAgdXBkYXRlTGlrZVRydWUoY2FyZElEKXtcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVSTCArIGAvY2FyZHMvbGlrZXMvYCArIGNhcmRJRCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICB9KVxuICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N1Y2Nlc3NmdWxSZXR1cm4ocmVzKTtcbiAgICAgIH0pXG4gIH1cblxuICB1cGRhdGVMaWtlRmFsc2UoY2FyZElEKXtcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVSTCArIGAvY2FyZHMvbGlrZXMvYCArIGNhcmRJRCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICB9KVxuICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N1Y2Nlc3NmdWxSZXR1cm4ocmVzKTtcbiAgICAgIH0pXG4gIH1cblxuICBnZXRVc2VySW5mbygpe1xuICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVVJMICsgYC91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICB9KVxuICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N1Y2Nlc3NmdWxSZXR1cm4ocmVzKTtcbiAgICAgIH0pXG4gIH1cblxuICB1cGRhdGVVc2VySW5mbyh2YWx1ZXMpe1xuICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVVJMICsgYC91c2Vycy9tZWAsXG4gICAge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIG1ldGhvZDpcIlBBVENIXCIsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh2YWx1ZXMpXG4gICAgfSlcbiAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zdWNjZXNzZnVsUmV0dXJuKHJlcyk7XG4gICAgICB9KVxuICB9XG5cbiAgdXBkYXRlQXZhdGFyKGxpbmspe1xuICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVVJMICsgYC91c2Vycy9tZS9hdmF0YXJgLFxuICAgIHtcbiAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIG1ldGhvZDpcIlBBVENIXCIsXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkobGluaylcbiAgICB9KVxuICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N1Y2Nlc3NmdWxSZXR1cm4ocmVzKTtcbiAgICAgIH0pXG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcblxuICBjb25zdHJ1Y3Rvcihwb3B1cCkge1xuICAgIHRoaXMuX3BvcHVwID0gcG9wdXA7XG5cbiAgICAvLyBwcmV2ZW50cyBoYW5kbGUgZXNjYXBlIGZyb20gcmVhY2hpbmcgZ2xvYmFsIHNjb3BlIGFuZCBicmVha2luZ1xuICAgIHRoaXMuX2Nsb3NlRXNjYXBlID0gdGhpcy5fY2xvc2VFc2NhcGUuYmluZCh0aGlzKTtcbiAgfVxuXG4gIG9wZW5Qb3B1cCgpe1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5fY2xvc2VFc2NhcGUpO1xuICB9XG5cbiAgY2xvc2VQb3B1cCgpe1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoYHBvcHVwX29wZW5lZGApO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2Nsb3NlRXNjYXBlKTtcbiAgfVxuXG4gIF9jbG9zZUVzY2FwZShldnQpIHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZVBvcHVwKCk7XG4gICAgfVxuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKXtcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Nsb3NlLWJ1dHRvblwiKTtcblxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoYGNsaWNrYCwgKCkgPT4ge1xuICAgICAgdGhpcy5jbG9zZVBvcHVwKCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT57XG4gICAgICBpZiAoZXZ0LnRhcmdldCA9PT0gZXZ0LmN1cnJlbnRUYXJnZXQpe1xuICAgICAgICB0aGlzLmNsb3NlUG9wdXAoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuXG5cblxuXG5cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiXG5cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBEZWxldGUgZXh0ZW5kcyBQb3B1cHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgcG9wdXBTdWJtaXQpe1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpXG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoYC5mb3JtYCk7XG4gICAgdGhpcy5fc3VibWl0ID0gcG9wdXBTdWJtaXQ7XG4gICAgLy8gcHJldmVudHMgaGFuZGxlIGVzY2FwZSBmcm9tIHJlYWNoaW5nIGdsb2JhbCBzY29wZSBhbmQgYnJlYWtpbmdcbiAgICB0aGlzLl9jbG9zZUVudGVyID0gdGhpcy5fY2xvc2VFbnRlci5iaW5kKHRoaXMpO1xuICB9XG5cbiAgb3BlblBvcHVwKGlkLCBjYXJkKXtcbiAgICBzdXBlci5vcGVuUG9wdXAoKTtcbiAgICB0aGlzLl9pZCA9IGlkO1xuICAgIHRoaXMuX2NhcmQgPSBjYXJkO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoYGtleWRvd25gLCB0aGlzLl9jbG9zZUVudGVyKVxuICB9XG5cbiAgY2xvc2VQb3B1cCgpe1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoYGtleWRvd25gLCB0aGlzLl9jbG9zZUVudGVyKVxuICAgIHN1cGVyLmNsb3NlUG9wdXAoKTtcbiAgfVxuXG4gIF9oYW5kbGVTdWJtaXQoZXZ0KXtcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB0aGlzLl9zdWJtaXQodGhpcy5faWQsIHRoaXMuX2NhcmQpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoYGtleWRvd25gLCB0aGlzLl9jbG9zZUVudGVyKVxuICB9XG5cbiAgX2Nsb3NlRW50ZXIoZXZ0KXtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFbnRlclwiKSB7XG4gICAgICB0aGlzLl9oYW5kbGVTdWJtaXQoZXZ0KTtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpe1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKGBzdWJtaXRgLCAoZXZ0KSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVTdWJtaXQoZXZ0KTtcbiAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yICh7aXRlbXMsIHJlbmRlcmVyfSwgY29udGFpbmVyKSB7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgfVxuXG4gIHJlbmRlckVsZW1lbnRzKCkge1xuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5hcHBlbmQoZWxlbWVudCk7XG4gIH1cblxuICBwcmVwSXRlbShlbGVtZW50KXtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxufVxuIiwiY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKGRhdGEsIHRlbXBsYXRlLCBoYW5kbGVDYXJkQ2xpY2ssIGhhbmRsZURlbGV0ZUNsaWNrLCBoYW5kbGVMaWtlQ2xpY2spe1xuICAgIHRoaXMuX3RleHQgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5faW1hZ2VMaW5rID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX3RlbXBsYXRlID0gdGVtcGxhdGU7XG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl9vd25lciA9IGRhdGEub3duZXIuX2lkO1xuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGljaztcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XG4gIH1cblxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fdGVtcGxhdGUpXG4gICAgICAuY29udGVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX2VsZW1lbnRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XG4gIH1cblxuICBfaGFuZGxlQ2FyZExpa2UoZXZ0KXtcbiAgICB0aGlzLl9pc0xpa2VkID0gIXRoaXMuX2lzTGlrZWQ7XG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrKHRoaXMuX2lkLCB0aGlzLl9pc0xpa2VkLCB0aGlzKTtcblxuICB9XG5cblxuICAgX2lzQWxyZWFkeUxpa2VkKHVzZXJJRCkge1xuICAgIHRoaXMuX2xpa2VzLmZvckVhY2gobGlrZSA9PiB7XG4gICAgICBpZiAobGlrZS5faWQgPT09IHVzZXJJRCkge1xuICAgICAgICB0aGlzLl9wbGFjZUNhcmQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c19faGVhcnRcIikuY2xhc3NMaXN0LmFkZChcImVsZW1lbnRzX19oZWFydF9hY3RpdmVcIik7XG4gICAgICAgIHRoaXMuX2lzTGlrZWQgPSAhdGhpcy5faXNMaWtlZDtcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgdXBkYXRlTGlrZXMob2JqKXtcbiAgICB0aGlzLl9saWtlc0NvdW50LnRleHRDb250ZW50ID0gb2JqLmxpa2VzLmxlbmd0aDtcbiAgICB0aGlzLl9wbGFjZUNhcmQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c19faGVhcnRcIikuY2xhc3NMaXN0LnRvZ2dsZShcImVsZW1lbnRzX19oZWFydF9hY3RpdmVcIik7XG5cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wbGFjZUNhcmQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c19faW1hZ2VcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+XG4gICAge2lmIChldnQudGFyZ2V0ID09PSBldnQuY3VycmVudFRhcmdldCl7XG4gICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sodGhpcy5fdGV4dCwgdGhpcy5faW1hZ2VMaW5rKTt9XG4gICAgfSlcblxuICAgIHRoaXMuX3BsYWNlQ2FyZC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzX19oZWFydFwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT5cbiAgICB7XG4gICAgICB0aGlzLl9oYW5kbGVDYXJkTGlrZShldnQpO1xuICAgIH0pXG4gIH1cblxuICBfaXNPd25lcih1c2VySUQpIHtcbiAgICBpZih0aGlzLl9vd25lciAhPT0gdXNlcklEKXtcbiAgICAgIHRoaXMuX3BsYWNlQ2FyZC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzX19kZWxldGVcIikucmVtb3ZlKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3BsYWNlQ2FyZC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzX19kZWxldGVcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XG4gICAgICB7XG4gICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKHRoaXMuX2lkLCB0aGlzLl9wbGFjZUNhcmQpO1xuICAgICAgfSlcbiAgICB9XG4gIH1cblxuICBtYWtlQ2FyZCh1c2VySUQpIHtcbiAgICB0aGlzLl9wbGFjZUNhcmQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2xpa2VzQ291bnQgPSB0aGlzLl9wbGFjZUNhcmQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c19fbGlrZS1jb3VudFwiKTtcbiAgICB0aGlzLl9wbGFjZUNhcmQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c19fdGl0bGVcIikudGV4dENvbnRlbnQgPSB0aGlzLl90ZXh0O1xuICAgIHRoaXMuX3BsYWNlQ2FyZC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzX19pbWFnZVwiKS5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKCR7dGhpcy5faW1hZ2VMaW5rfSlgO1xuICAgIHRoaXMuX2xpa2VzQ291bnQudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGhcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX2lzT3duZXIodXNlcklEKTtcbiAgICB0aGlzLl9pc0FscmVhZHlMaWtlZCh1c2VySUQpO1xuXG5cbiAgICByZXR1cm4gdGhpcy5fcGxhY2VDYXJkO1xuICB9XG59XG5cblxuZXhwb3J0IHtDYXJkfTtcbiIsIlxuaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCJcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yIChwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fcG9wdXBJbWFnZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoYC5pbWFnZS1wb3B1cGApO1xuICAgIHRoaXMuX3BvcHVwQ2FwdGlvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoYC5pbWFnZS1jYXB0aW9uYCk7XG4gIH1cblxuICBvcGVuUG9wdXAodGV4dCwgbGluayl7XG4gICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSBsaW5rO1xuICAgIHRoaXMuX3BvcHVwSW1hZ2UuYWx0ID0gdGV4dDtcbiAgICB0aGlzLl9wb3B1cENhcHRpb24udGV4dENvbnRlbnQgPSB0ZXh0O1xuICAgIHN1cGVyLm9wZW5Qb3B1cCgpO1xuICB9XG59XG4iLCJcbmltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yIChwb3B1cFNlbGVjdG9yLCBmb3JtU3VibWl0LCBmb3JtT3Blbikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKGAuZm9ybWApO1xuICAgIHRoaXMuX2Zvcm1TdWJtaXQgPSBmb3JtU3VibWl0O1xuICAgIHRoaXMuX2Zvcm1PcGVuID0gZm9ybU9wZW47XG4gIH1cblxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZyl7XG4gICAgdGhpcy5fc2F2ZUJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcIi5mb3JtX19zYXZlLWJ1dHRvblwiKVxuICAgIGNvbnN0IG9nVGV4dCA9IHRoaXMuX3NhdmVCdXR0b24udGV4dENvbnRlbnQ7XG4gICAgaWYoaXNMb2FkaW5nKXtcbiAgICAgIHRoaXMuX3NhdmVCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zYXZlQnV0dG9uLnRleHRDb250ZW50LnNsaWNlKDAsIC0xKStcImluZy4uLlwiO1xuICAgIH1lbHNle1xuICAgICAgdGhpcy5fc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3NhdmVCdXR0b24udGV4dENvbnRlbnQuc2xpY2UoMCwgLTYpK1wiZVwiO1xuICAgIH1cbiAgfVxuICBfZ2V0SW5wdXRWYWx1ZXMoKXtcbiAgICBjb25zdCB2YWx1ZXMgPSB7fTtcbiAgICBjb25zdCBpbnB1dHMgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbChgLmZvcm1fX2ZpZWxkYCkpO1xuXG4gICAgaW5wdXRzLmZvckVhY2goaW5wdXQgPT4ge1xuICAgICAgdmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIHZhbHVlcztcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCl7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihgc3VibWl0YCwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9mb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgIH0pO1xuICB9XG5cbiAgY2xvc2VQb3B1cCgpe1xuICAgIHN1cGVyLmNsb3NlUG9wdXAoKTtcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XG4gIH1cblxuICBvcGVuUG9wdXAoKXtcbiAgICBzdXBlci5vcGVuUG9wdXAoKTtcbiAgICB0aGlzLl9mb3JtT3BlbigpO1xuICB9XG59XG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IoY29uZmlnLCBmb3JtKXtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gY29uZmlnLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IGNvbmZpZy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IGNvbmZpZy5lcnJvckNsYXNzO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybTtcbiAgICB0aGlzLl9zYXZlQnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gIH1cblxuICAvLy0tIFNob3dpbmcvSGlkaW5nIEVycm9yIE1lc3NhZ2VzXG4gICAgX3Nob3dJbnB1dEVycm9yIChpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkge1xuICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50Lm5hbWV9LWVycm9yYCk7XG4gICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XG4gICAgfTtcblxuICAgIF9oaWRlSW5wdXRFcnJvciAoaW5wdXRFbGVtZW50KSB7XG4gICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQubmFtZX0tZXJyb3JgKTtcbiAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgfTtcbiAgLy8tLVxuXG4gIC8vLS0gRm9ybSBWYWxpZGl0eSBDaGVja3NcbiAgICBfY2hlY2tJbnB1dFZhbGlkaXR5IChpbnB1dEVsZW1lbnQpIHtcbiAgICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIF9oYXNJbnZhbGlkSW5wdXQgKGlucHV0TGlzdCkge1xuICAgICAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+XG4gICAgICB7XG4gICAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xuICAgICAgfSlcbiAgICB9O1xuICAvLy0tXG5cbiAgLy8tLSBFbi9EaXMtYWJsaW5nIFN1Ym1pdCBCdXR0b25zIEJhc2VkIG9uIFZhbGlkaXR5IG9mIFRoZWlyIENvcnJlc3BvbmRpbmcgRm9ybXNcbiAgICBfdG9nZ2xlQnV0dG9uU3RhdGUgKGlucHV0TGlzdCkge1xuICAgICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XG4gICAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5lbmFibGVCdXR0b24oKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgZGlzYWJsZUJ1dHRvbigpe1xuICAgICAgdGhpcy5fc2F2ZUJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCB0cnVlKTtcbiAgICAgIHRoaXMuX3NhdmVCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB9XG5cbiAgICBlbmFibGVCdXR0b24oKXtcbiAgICAgIHRoaXMuX3NhdmVCdXR0b24ucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XG4gICAgICB0aGlzLl9zYXZlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgfVxuICAvLy0tXG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzICgpIHtcbiAgICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcikpO1xuXG5cbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QpO1xuXG4gICAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT5cbiAgICB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICAoKSA9PlxuICAgICAge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcblxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QpXG4gICAgICB9KTtcbiAgICB9KTtcblxuXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PlxuICAgIHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICB9O1xuXG4gICBlbmFibGVWYWxpZGF0aW9uICgpIHtcbiAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKHRoaXMuX2Zvcm1FbGVtZW50KTtcbiAgfTtcbn1cbmV4cG9ydCB7Rm9ybVZhbGlkYXRvcn07XG4iLCJleHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XG4gIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2ZpZWxkXCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19zYXZlLWJ1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcImZvcm1fX3NhdmUtYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJmb3JtX19maWVsZF9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcImZvcm1fX2ZpZWxkLWVycm9yX2FjdGl2ZVwiXG59O1xuXG5leHBvcnQgY29uc3QgbXlBdXRoID0ge1xuICBiYXNlVVJMOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtN1wiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCJhNTQ1NGYyMi1lYWI1LTQzODQtOGUyNi01N2IxMjdmNTY1NTFcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICB9XG59O1xuXG4vLyBHZW5lcmFsIFBhZ2UgVmFyc1xuICBjb25zdCBwYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wYWdlXCIpO1xuICBjb25zdCBwcm9maWxlID0gcGFnZS5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVcIik7XG4gIGV4cG9ydCBjb25zdCBwb3B1cEVkaXQgPSBwYWdlLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfZWRpdC1mb3JtXCIpO1xuICBleHBvcnQgY29uc3QgcG9wdXBBZGQgPSBwYWdlLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfYWRkLWZvcm1cIik7XG4gIGV4cG9ydCBjb25zdCBwb3B1cEF2YXRhciA9IHBhZ2UucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9hdmF0YXItZm9ybVwiKTtcbiAgZXhwb3J0IGNvbnN0IHBvcHVwRGVsZXRlID0gcGFnZS5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX2RlbGV0ZVwiKVxuICAvLyBFZGl0IGZvcm0gVmFyc1xuICBleHBvcnQgY29uc3QgZWRpdCA9IHByb2ZpbGUucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcbiAgZXhwb3J0IGNvbnN0IG15TmFtZSA9IHByb2ZpbGUucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xuICBleHBvcnQgY29uc3QgbXlPY2N1cGF0aW9uID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX29jY3VwYXRpb25cIik7XG4gIGV4cG9ydCBjb25zdCBlZGl0Rm9ybSA9IGRvY3VtZW50LmZvcm1zLmVkaXQ7XG4gIGV4cG9ydCBjb25zdCBuYW1lRm9ybSA9IGVkaXRGb3JtLmVsZW1lbnRzLm5hbWU7XG4gIGV4cG9ydCBjb25zdCBvY2N1cGF0aW9uRm9ybSA9IGVkaXRGb3JtLmVsZW1lbnRzLmFib3V0O1xuICBleHBvcnQgY29uc3Qgc2F2ZSA9IHBvcHVwRWRpdC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX3NhdmUtYnV0dG9uXCIpO1xuLy8gUGxhY2UgQ2FyZCBhbmQgQWRkIEZvcm0gVmFyc1xuICBleHBvcnQgY29uc3QgYWRkID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG4gIGV4cG9ydCBjb25zdCBjcmVhdGUgPSBwb3B1cEFkZC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX3NhdmUtYnV0dG9uXCIpO1xuICBleHBvcnQgY29uc3QgYWRkRm9ybSA9IGRvY3VtZW50LmZvcm1zLmFkZDtcbi8vIEF2YXRhciBGb3JtIFZhcnNcbiAgZXhwb3J0IGNvbnN0IGF2YXRhciA9IHByb2ZpbGUucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZS1lZGl0XCIpO1xuICBleHBvcnQgY29uc3QgYXZhdGFySW1hZ2UgPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpXG4gIGV4cG9ydCBjb25zdCBhdmF0YXJGb3JtID0gZG9jdW1lbnQuZm9ybXMuYXZhdGFyO1xuICBleHBvcnQgY29uc3QgYXZhdGFyU2F2ZSA9IHBvcHVwQXZhdGFyLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fc2F2ZS1idXR0b25cIik7XG4vLyBFbGVtZW50IENhcmQgVGVtcGxhdGUgVmFyc1xuICBleHBvcnQgY29uc3QgY2FyZENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZC1jb250YWluZXJcIik7XG4vLyBJbWFnZSBQb3B1cCBWYXJzXG4gIGV4cG9ydCBjb25zdCBwb3B1cEltYWdlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfaW1hZ2VcIik7XG4vLyBEZWxldGUgRm9ybSBWYXJzXG4gIGV4cG9ydCBjb25zdCBkZWxldGVGb3JtID0gZG9jdW1lbnQuZm9ybXMuZGVsZXRlO1xuICBleHBvcnQgY29uc3QgZGVsZXRlQ29uZmlybSA9IHBvcHVwRGVsZXRlLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fc2F2ZS1idXR0b25cIik7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKG15TmFtZSwgbXlPY2N1cGF0aW9uLCBwcm9maWxlSW1hZ2UpIHtcbiAgICB0aGlzLl9wcm9maWxlSW1hZ2UgPSBwcm9maWxlSW1hZ2U7XG4gICAgdGhpcy5fbXlOYW1lID0gbXlOYW1lO1xuICAgIHRoaXMuX215T2NjdXBhdGlvbiA9IG15T2NjdXBhdGlvbjtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIGNvbnN0IHVzZXJOYW1lID0gdGhpcy5fbXlOYW1lLnRleHRDb250ZW50O1xuICAgIGNvbnN0IG9jY3VwYXRpb24gPSB0aGlzLl9teU9jY3VwYXRpb24udGV4dENvbnRlbnQ7XG4gICAgcmV0dXJuIHtuYW1lOiB1c2VyTmFtZSwgYWJvdXQ6IG9jY3VwYXRpb259XG4gIH1cblxuICBzZXRVc2VySW5mbyhkYXRhKSB7XG4gICAgdGhpcy5fbXlOYW1lLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX215T2NjdXBhdGlvbi50ZXh0Q29udGVudCA9IGRhdGEuYWJvdXQ7XG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLnNldEF2YXRhcihkYXRhKVxuICB9XG5cblxuICBzZXRBdmF0YXIoZGF0YSl7XG4gICAgdGhpcy5fcHJvZmlsZUltYWdlLnNldEF0dHJpYnV0ZShcInNyY1wiLCBkYXRhLmF2YXRhcilcbiAgfVxuXG4gIGdldElEKCl7XG4gICAgcmV0dXJuIHRoaXMuX2lkO1xuICB9XG59XG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcbmltcG9ydCBQb3B1cERlbGV0ZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cERlbGV0ZS5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IHtDYXJkfSBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCB7Rm9ybVZhbGlkYXRvcn0gZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0ICogYXMgY29uc3RhbnRzIGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcbmltcG9ydCB7bXlOYW1lLCBteU9jY3VwYXRpb259ZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm9cIjtcblxuXG5cbi8vIEluaXRpYWwgQ2xhc3NlcyBhbmQgZnVuY3Rpb25zXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgY29uc3QgYXBpID0gbmV3IEFwaShjb25zdGFudHMubXlBdXRoKTtcblxuICBQcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvKCksIGFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pXG4gICAgLnRoZW4oKFtyZXNVc2VySW5mbywgcmVzSW5pdENhcmRzXSkgPT4ge1xuICAgICAgdXNlckluZm9ybWF0aW9uLnNldFVzZXJJbmZvKHJlc1VzZXJJbmZvKTtcblxuXG4gICAgICAvLyBBIFNlY3Rpb24gZm9yIHRoZSBFZGl0IEZvcm1cbiAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIGNvbnN0IGVkaXRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICAgICAgICAgIGNvbnN0YW50cy5wb3B1cEVkaXQsXG4gICAgICAgICAgKHZhbHVlcykgPT4ge1xuICAgICAgICAgICAgLy9oYW5kbGVzIHdoYXQgaGFwcGVucyB3aGVuIHRoaXMgZm9ybSBpcyBzdWJtaXR0ZWRcbiAgICAgICAgICAgIGVkaXRQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICAgICAgICAgICAgYXBpLnVwZGF0ZVVzZXJJbmZvKHZhbHVlcylcbiAgICAgICAgICAgICAgLnRoZW4oIHZhbHVlcyA9PntcbiAgICAgICAgICAgICAgICB1c2VySW5mb3JtYXRpb24uc2V0VXNlckluZm8odmFsdWVzKTtcbiAgICAgICAgICAgICAgICBlZGl0UG9wdXAuY2xvc2VQb3B1cCgpO1xuICAgICAgICAgICAgICAgIGVkaXRQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coKGBZb3VyIHByb2ZpbGUgaXMgb3V0IG9mIHdhY2s6ICR7ZXJyfWApKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICApXG4gICAgICAgICAgfSxcbiAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAvL2hhbmRsZXMgd2hhdCBoYXBwZW5zIHdoZW4gdGhpcyBmb3JtIGlzIG9wZW5lZFxuICAgICAgICAgICAgY29uc3Qge25hbWUsIGFib3V0fSA9IHVzZXJJbmZvcm1hdGlvbi5nZXRVc2VySW5mbygpO1xuICAgICAgICAgICAgY29uc3RhbnRzLm5hbWVGb3JtLnZhbHVlID0gbmFtZTtcbiAgICAgICAgICAgIGNvbnN0YW50cy5vY2N1cGF0aW9uRm9ybS52YWx1ZSA9IGFib3V0O1xuICAgICAgICAgICAgZWRpdFZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKGNvbnN0YW50cy5zYXZlKTtcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIGVkaXRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuICAgICAgICBjb25zdGFudHMuZWRpdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgZWRpdFBvcHVwLm9wZW5Qb3B1cCgpO1xuICAgICAgICB9KTtcbiAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblxuXG4gICAgICAvLyBjb2RlIGZvciByZW5kZXJpbmcgdGhlIGluaXRpYWwgY2FyZHNcbiAgICAgICAgY29uc3QgY2FyZHMgPSBuZXcgU2VjdGlvbihcbiAgICAgICAgICB7XG4gICAgICAgICAgICBpdGVtczogcmVzSW5pdENhcmRzLFxuICAgICAgICAgICAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgIGNhcmRzLmFkZEl0ZW0obWFrZUFOZXdDYXJkKGl0ZW0pKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBjb25zdGFudHMuY2FyZENvbnRhaW5lclxuICAgICAgICApXG4gICAgICAgIGNhcmRzLnJlbmRlckVsZW1lbnRzKCk7XG5cblxuICAgICAgLy8gY29kZSBmb3IgdGhlIGFkZCBjYXJkIGZvcm1cbiAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIGNvbnN0IGFkZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gICAgICAgICAgY29uc3RhbnRzLnBvcHVwQWRkLCAoZGF0YSkgPT4ge1xuICAgICAgICAgICAgLy9oYW5kbGVzIHdoYXQgaGFwcGVucyB3aGVuIHRoaXMgZm9ybSBpcyBzdWJtaXR0ZWRcbiAgICAgICAgICAgICAgYWRkUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgICAgICAgICAgICAgYXBpLmFkZENhcmQoZGF0YSlcbiAgICAgICAgICAgICAgLnRoZW4ocmVzPT57XG4gICAgICAgICAgICAgICAgY2FyZHMucHJlcEl0ZW0obWFrZUFOZXdDYXJkKHJlcykpO1xuICAgICAgICAgICAgICAgIGFkZFBvcHVwLmNsb3NlUG9wdXAoKTtcbiAgICAgICAgICAgICAgICBhZGRQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coKGBDYXJkIGNvdWxkIG5vdCBiZSBkZWxpdmVyZWQgYXMgZGlhbGVkOiAke2Vycn1gKSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICB9LCAoKSA9PiB7XG4gICAgICAgICAgICAvL2hhbmRsZXMgd2hhdCBoYXBwZW5zIHdoZW4gdGhpcyBmb3JtIGlzIG9wZW5lZFxuICAgICAgICAgICAgYWRkVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKTtcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIGFkZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgICAgIGNvbnN0YW50cy5hZGQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGFkZFBvcHVwLm9wZW5Qb3B1cCgpO1xuICAgICAgICB9KTtcbiAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblxuICAgICAgLy9TdGFuZGFyZCBDYXJkIENyZWF0aW9uXG4gICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICBmdW5jdGlvbiBoYW5kbGVDYXJkQ2xpY2sodGV4dCwgbGluayl7XG4gICAgICAgICAgaW1hZ2VQb3Aub3BlblBvcHVwKHRleHQsIGxpbmspXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBtYWtlQU5ld0NhcmQoZGF0YSl7XG4gICAgICAgICAgY29uc3QgaW5pdENhcmQgPSBuZXcgQ2FyZChkYXRhLCBcIi5vd25lci10ZW1wbGF0ZVwiLCBoYW5kbGVDYXJkQ2xpY2ssIGhhbmRsZURlbGV0ZUNsaWNrLCBoYW5kbGVMaWtlQ2xpY2spO1xuICAgICAgICAgIGNvbnN0IGxvYWRDYXJkID0gaW5pdENhcmQubWFrZUNhcmQodXNlckluZm9ybWF0aW9uLmdldElEKCkpO1xuICAgICAgICAgIHJldHVybiBsb2FkQ2FyZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGhhbmRsZUxpa2VDbGljayhjYXJkSWQsIGlzTGlrZWQsIGNhcmQpIHtcbiAgICAgICAgICBpZihpc0xpa2VkKXtcbiAgICAgICAgICAgIGFwaS51cGRhdGVMaWtlVHJ1ZShjYXJkSWQpXG4gICAgICAgICAgICAgIC50aGVuKHJlcyA9PntcbiAgICAgICAgICAgICAgICBjYXJkLnVwZGF0ZUxpa2VzKHJlcylcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coKGBFcnIsIHlvdSBzdXJlIHlvdSBsaWtlIHRoYXQ/OiAke2Vycn1gKSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhcGkudXBkYXRlTGlrZUZhbHNlKGNhcmRJZClcbiAgICAgICAgICAgICAgLnRoZW4ocmVzID0+e1xuICAgICAgICAgICAgICAgIGNhcmQudXBkYXRlTGlrZXMocmVzKVxuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygoYEMnbW9uLCBldmVyeW9uZSBsb3ZlcyB0aGF0ITogJHtlcnJ9YCkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIClcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgICAgLy8gQSBTZWN0aW9uIGZvciB0aGUgQXZhdGFyIFBvcHVwXG4gICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICBjb25zdCBhdmF0YXJQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICAgICAgICAgIGNvbnN0YW50cy5wb3B1cEF2YXRhcixcbiAgICAgICAgICAodmFsdWUpPT4ge1xuICAgICAgICAgICAgLy9oYW5kbGVzIHdoYXQgaGFwcGVucyB3aGVuIHRoaXMgZm9ybSBpcyBzdWJtaXR0ZWRcbiAgICAgICAgICAgICAgYXZhdGFyUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgICAgICAgICAgICAgYXBpLnVwZGF0ZUF2YXRhcih2YWx1ZSlcbiAgICAgICAgICAgICAgLnRoZW4oIHZhbHVlID0+IHtcbiAgICAgICAgICAgICAgICB1c2VySW5mb3JtYXRpb24uc2V0QXZhdGFyKHthdmF0YXI6IHZhbHVlLmF2YXRhcn0pXG4gICAgICAgICAgICAgICAgYXZhdGFyUG9wdXAuY2xvc2VQb3B1cCgpO1xuICAgICAgICAgICAgICAgIGF2YXRhclBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygoYEFhbmcsIHlvdXIgY2hpIGlzIG91dCBvZiBmb2N1czogJHtlcnJ9YCkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIClcbiAgICAgICAgICB9LFxuICAgICAgICAgICgpPT4ge1xuICAgICAgICAgICAgYXZhdGFyVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oY29uc3RhbnRzLmF2YXRhclNhdmUpO1xuICAgICAgICAgIH1cbiAgICAgICAgKVxuICAgICAgICBhdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuICAgICAgICBjb25zdGFudHMuYXZhdGFyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbigpe1xuICAgICAgICAgIGF2YXRhclBvcHVwLm9wZW5Qb3B1cCgpO1xuICAgICAgICB9KVxuICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICB9KVxuICAgIC5jYXRjaChlcnIgPT4ge1xuICAgICAgY29uc29sZS5sb2coKGBIb3VzdG9uLCB3ZSBoYXZlIGEgcHJvYmxlbS4uLiB0aGlzIG9uZSBpbiBmYWN0OiAke2Vycn1gKSk7XG4gICAgfVxuICAgIClcblxuXG4vLyBJbml0aWFsIFVzZXIgSW5mb1xuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbmNvbnN0IHVzZXJJbmZvcm1hdGlvbiA9IG5ldyBVc2VySW5mbyhteU5hbWUsIG15T2NjdXBhdGlvbiwgY29uc3RhbnRzLmF2YXRhckltYWdlKTtcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbi8vIEltYWdlIFBvcHVwIEluaXRpYWxpemF0aW9uXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICBjb25zdCBpbWFnZVBvcCA9IG5ldyBQb3B1cFdpdGhJbWFnZShjb25zdGFudHMucG9wdXBJbWFnZXMpO1xuICBpbWFnZVBvcC5zZXRFdmVudExpc3RlbmVycygpO1xuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuLy8gRm9ybSBWYWxpZGF0b3JzXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICBmdW5jdGlvbiBuZXdWYWxpZGF0b3IgKGZvcm1FbGVtZW50KSB7XG4gICAgY29uc3QgbmV3Rm9ybSA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbnN0YW50cy5zZXR0aW5ncywgZm9ybUVsZW1lbnQpXG4gICAgbmV3Rm9ybS5lbmFibGVWYWxpZGF0aW9uKCk7XG4gICAgcmV0dXJuIG5ld0Zvcm07XG4gIH1cbiAgY29uc3QgYWRkVmFsaWRhdG9yID0gbmV3VmFsaWRhdG9yKGNvbnN0YW50cy5hZGRGb3JtKTtcbiAgY29uc3QgZWRpdFZhbGlkYXRvciA9IG5ld1ZhbGlkYXRvcihjb25zdGFudHMuZWRpdEZvcm0pO1xuICBjb25zdCBhdmF0YXJWYWxpZGF0b3IgPSBuZXdWYWxpZGF0b3IoY29uc3RhbnRzLmF2YXRhckZvcm0pO1xuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuLy9BIFNlY3Rpb24gZm9yIHRoZSBEZWxldGUgUG9wdXBcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIGZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNsaWNrKGlkLCBjYXJkKXtcbiAgICBkZWxldGVQb3B1cC5vcGVuUG9wdXAoaWQsIGNhcmQpXG4gIH1cbiAgY29uc3QgZGVsZXRlUG9wdXAgPSBuZXcgUG9wdXBEZWxldGUoXG4gICAgY29uc3RhbnRzLnBvcHVwRGVsZXRlLFxuICAgIChpZCwgY2FyZCk9PiB7XG4gICAgICBhcGkuZGVsZXRlQ2FyZChpZClcbiAgICAgIC50aGVuKFxuICAgICAgICBjYXJkLnJlbW92ZSgpLFxuICAgICAgICBkZWxldGVQb3B1cC5jbG9zZVBvcHVwKCksXG4gICAgICApXG4gICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coKGBJJ20gc29ycnkgRGF2ZSwgSSdtIGFmcmFpZCBJIGNhbid0IGRvIHRoYXQ6ICR7ZXJyfWApKTtcbiAgICAgIH1cbiAgICAgIClcbiAgICB9XG4gIClcbiAgZGVsZXRlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4iXSwic291cmNlUm9vdCI6IiJ9